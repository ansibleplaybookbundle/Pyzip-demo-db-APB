FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDY0Mjk3ZTg4LTY1N2MtNDZhYi1iYjUwLTJhZjdmODRlNWVjNgpuYW1lOiBweXppcC1kZW1v\
LWRiLWFwYgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL3B5emlwLWRlbW8tZGItYXBiCmRl\
c2NyaXB0aW9uOiBQeXRob24gWmlwIERlbW8gUG9zdGdyZVNRTCBBUEIgaW1wbGVtZW50YXRpb24K\
YmluZGFibGU6IHRydWUKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAi\
UHl6aXAgRGVtbyBEYXRhYmFzZSBBUEIiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQSBzYW1wbGUgcG9z\
dGdyZXNxbCBkYXRhYmFzZSB3aXRoIEdJUyBzdXBwb3J0IGFuZCBzZWVkZWQgZGF0YSBmb3IgYSBk\
ZW1vbnN0cmF0aW9uIHB5dGhvbiB3ZWJhcHAsIGh0dHBzOi8vZ2l0aHViLmNvbS9mdXNvci9weS16\
aXAtZGVtbyIKICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9mdXNvci8yMDE3\
ZGVtby82NHB4LVBvc3RncmVzcWxfZWxlcGhhbnQuc3ZnLnBuZyIKICBkb2N1bWVudGF0aW9uVXJs\
OiAiaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5vcmcvZG9jcy8iCnBhcmFtZXRlcnM6CiAgLSBwb3N0\
Z3Jlc3FsX2RhdGFiYXNlOgogICAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFzZSBOYW1lCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiBhZG1pbgogIC0gcG9zdGdyZXNxbF9wYXNz\
d29yZDoKICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFzc3dvcmQKICAgICAgZGVzY3JpcHRpb246\
IEEgcmFuZG9tIGFscGhhbnVtZXJpYyBzdHJpbmcgaWYgbGVmdCBibGFuawogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgZGVmYXVsdDogYWRtaW4KICAtIHBvc3RncmVzcWxfdXNlcjoKICAgICAgdGl0\
bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogYWRt\
aW4KICAgICAgbWF4bGVuZ3RoOiA2MwpyZXF1aXJlZDoKICAtIHBvc3RncmVzcWxfZGF0YWJhc2UK\
ICAtIHBvc3RncmVzcWxfdXNlcgo="

COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions

RUN yum install -y postgresql && yum clean all

USER apb
