FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDY0Mjk3ZTg4LTY1N2MtNDZhYi1iYjUwLTJhZjdmODRlNWVjNgpuYW1lOiBweXppcC1kZW1v\
LWRiLWFwYgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL3B5emlwLWRlbW8tZGItYXBiCmRl\
c2NyaXB0aW9uOiBQeXRob24gWmlwIERlbW8gRGF0YWJhc2UgQVBCIEltcGxlbWVudGF0aW9uCmJp\
bmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogIlB5\
emlwIERlbW8gRGF0YWJhc2UgKEFQQikiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQSBkYXRhYmFzZSB3\
aXRoIEdJUyBzdXBwb3J0IGFuZCBzZWVkZWQgZGF0YSBmb3IgYSBkZW1vbnN0cmF0aW9uIHB5dGhv\
biB3ZWJhcHAsIGh0dHBzOi8vZ2l0aHViLmNvbS9mdXNvci9weS16aXAtZGVtbyIKICBjb25zb2xl\
Lm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGljb24tcG9zdGdyZXNxbAogIGRvY3VtZW50YXRpb25V\
cmw6ICJodHRwczovL2dpdGh1Yi5jb20vZnVzb3IvYXBiLWV4YW1wbGVzL3RyZWUvbWFzdGVyL3B5\
emlwLWRlbW8tZGItYXBiIgpwYXJhbWV0ZXJzOgogIC0gZGF0YWJhc2VfbmFtZToKICAgICAgdGl0\
bGU6IERhdGFiYXNlIE5hbWUKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6IGFkbWlu\
CiAgLSBkYXRhYmFzZV9wYXNzd29yZDoKICAgICAgdGl0bGU6IERhdGFiYXNlIFBhc3N3b3JkCiAg\
ICAgIGRlc2NyaXB0aW9uOiBBIHJhbmRvbSBhbHBoYW51bWVyaWMgc3RyaW5nIGlmIGxlZnQgYmxh\
bmsKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6IGFkbWluCiAgLSBkYXRhYmFzZV91\
c2VyOgogICAgICB0aXRsZTogRGF0YWJhc2UgVXNlcgogICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
ZGVmYXVsdDogYWRtaW4KICAgICAgbWF4bGVuZ3RoOiA2MwpyZXF1aXJlZDoKICAtIGRhdGFiYXNl\
X25hbWUKICAtIGRhdGFiYXNlX3VzZXIK"

COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions

RUN yum install -y postgresql && yum clean all

USER apb
